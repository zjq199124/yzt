<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.maizhiyu.yzt.mapper.BuDiagnoseMapper">
 
    <resultMap type="com.maizhiyu.yzt.entity.BuDiagnose" id="BuDiagnoseMap">
        <result column="id" property="id"  jdbcType="BIGINT"/>
        <result column="status" property="status"/>
        <result column="customer_id" property="customerId"/>
        <result column="department_id" property="departmentId"/>
        <result column="doctor_id" property="doctorId"/>
        <result column="patient_id" property="patientId"/>
        <result column="outpatient_id" property="outpatientId"/>
        <result column="disease_id" property="diseaseId"/>
        <result column="disease" property="disease"/>
        <result column="syndrome" property="syndrome"/>
        <result column="syndrome_id" property="syndromeId"/>
        <result column="symptoms" property="symptoms"/>
        <result column="symptom_ids" property="symptomIds"/>
        <result column="medical_history" property="medicalHistory"/>
        <result column="family_history" property="familyHistory"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
        <result column="is_del" property="isDel"/>
        <result column="name" property="name"/>
        <result column="phone" property="phone"/>
    </resultMap>
    <select id="selectDiagnoseList" resultType="com.maizhiyu.yzt.entity.BuDiagnose">
        select bp.name,bp.phone,bd.id,bd.disease,bd.syndrome,bd.create_time from bu_diagnose bd
        left join bu_patient bp on bd.patient_id = bp.id and bp.is_del = 0
        where bd.is_del = 0 and bd.customer_id = #{customerId}
        <if test="term != null and term != ''">
            and (bd.disease like concat('%',#{term},'%') or bp.name like concat('%',#{term},'%') or bp.phone like concat('%',#{term},'%') or bp.idcard like concat('%',#{term},'%'))
        </if>
        order by bd.create_time desc
    </select>

</mapper>
